*上次修改日期：2024.6.5*

*修改人：GDC*

------



# 摘要：

此文档为PVM游戏的设计文档，随时可以做出调整



------



# 资源

## 分类:

- 初级资源 : 煤,铁,石头,水,原木

- 能源 : 煤,电

- 加工资源 : 钢铁,木材

## 作用:

- 铁 : 1.加工成钢铁;2.卖钱;

- 钢铁 : 1.卖钱;2.充当建筑材料(某些建筑建造时需要这个材料)3.参与武器制作(箭矢... )

- 煤 : 1.发电;2.卖钱;

- 石头 : 1.卖钱;2.充当建筑材料;3.充当投石机的炮弹

- 水 : 1.卖钱;2.工业用水(矿井、炼铁厂运行时需要水,而且各种功能建筑中的工人等都需要消耗水)

- 原木 : 1.卖钱;2.可以加工成木材;3.发电

- 木材 : 1.卖钱;2.充当建筑材料;3.参与武器制作

- 电 : 充当能源(一些建筑的运行等需要耗电,如:高压铁丝网反甲时用电点击敌人)

## 获取途径:

- 铁 : 通过矿井开采铁矿脉资源点获得

- 钢铁 : 通过炼铁厂将铁炼成钢

- 煤 : 通过矿井开采煤矿脉资源点获得

- 石头 : 通过采石场开采石头资源点获得

- 水 : 通过抽水机从河流或湖泊获取

- 原木 : 通过伐木场开采森林资源点获得

- 木材 : 通过木材加工厂将原木加工成木材

- 电 : 1.热电站发电(燃料:煤、原木);2.核电站发电

## 消耗：

- <u>绝大多数建筑物运行时需要消耗物品（如：炼铁厂需要工业用水，工人需要食物......）</u>
- 建筑物在回血时会消耗钱

## 资源点：

- 铁矿脉

- 煤矿脉

- 森林

- 山

- 水源

  ------

  

# 建筑物

## 通用：

1. **<u>除运输中心外的所有建筑都必须连接到主基地才能正常运行</u>**（城墙等建筑物当未连接到主基地时不会进行自动会血）
2. 玩家可以点击建筑物来查看建筑物的详细信息（血量、是否在运行、是否连接到主基地、如矿井：当前开采的资源类型是什么......），以及可以对此建筑物进行调整（停止或开始运行、摧毁、如矿井：切换要开采的资源类型）
3. 某些建筑只能建造在陆地（矿井、防御类建筑），有些建筑水陆都能建造（抽水塔（虽然放在陆地上就不能抽水了，但还可以放））
4. 所有建筑物在连接到主基地的情况下均可以回血（回血条件：一段时间不受到攻击且连接到主基地）

## 类型：

- 资源 ：矿井（开采煤铁），伐木场（开采木头），采石场（开采石头），抽水机（抽水），木材加工厂（将原木加工为木材），炼铁厂（将铁烧成钢），耕地（种植食物），杂交水稻（产量与效率比耕地高），农业大棚（产量与效率最高，收气候影响比耕地与杂交水稻小得多），军事基地（制造各种炮弹，箭矢，导弹，核弹）

- 防御 ：城墙，篱笆，高压铁丝网（电击靠近的敌人）

- 运输 ：运输中心

- 攻击 ：标准箭塔，散射箭塔，投石机，石头散射塔，电磁炮塔，加农炮塔，火箭炮塔，集束火箭炮塔，核弹发射基地

  ------

  

# 系统：

## 商店系统：

玩家可以在游戏开始时进入商店，可以出售资源来获取钱，也可以用自己的钱买资源

## 运输系统：

运输中心：在一个半径r内所有的建筑物都会与运输中心连接，运输中心将会每隔一段时间更新一次连接到的建筑物，并会在每一次更新时检查球形射线检测检测到的建筑物中有没有主基地或者有没有那个建筑物已经连接到了主基地，以此来确定该运输中心是否连接到主基地。当连接到主基地时，运输中心会将连接到的建筑物的isConnectedMainBase（是否连接到主基地）变量设置为true；当自身未连接到时或被摧毁时将所有连接到的建筑物的isConnectedMainBase设置为false

## 天气系统：

每一个地图都对应着一个气候类型（如新乡对应着温带季风气候），气候的条件会影响此关卡的难易程度（如亚热带季风和亚热带湿润气候就要比寒带气候要优越，适宜农业生产，所以玩家的食物获取将会比在寒带更为容易和快速）。每一个气候类型将对应它的柱状图，游戏运行时将会根据柱状图来确定每个月的降水与温度（时间设定：1s一天，默认从三月三十一日（春分）开始）。

## 农业系统：

- 建筑：耕地，杂交水稻，农业大棚

- 影响：气候（农业生长速度将会受当天的温度，降水，以及离水源的距离的影响，根据这三个条件来总结出一个公式

  若s为生长速度，t为当天温度，w为当天降水，d为离水源的距离，则有
  $$
  s=\frac{\sqrt{(t+w)d}}{2d}
  $$
  来计算出一个农业建筑一天的生长速度（百分数））

## 出怪系统：

- 敌人分波次进攻
- 敌人的数量与强度会随着波次的增加而增加
- <u>每隔1年会让玩家重新选卡</u>
- boss关的最后一波出boss

## 选卡系统：

<u>**游戏开始时的选卡阶段，玩家可以选16种建筑物，只有选满16个才能开始**</u>

## 技能系统：

玩家可以按下Q来打开技能UI页面，技能树玩家可以选择一些增益或效果（**玩家一旦选择就无法反悔**），如：加伤害。每个技能都有解锁条件，解锁条件（所有下面提到的值与技术在解锁增益或效果时不消耗）有：冷兵器经验，热武器经验，农耕经验，防御经验，科技值，经济实力，技术（升级时不仅需要前面提到的各种值，有些还需要相应的技术）……获取途径如下

- 冷兵器经验：通过冷兵器（标准箭塔，散射箭塔，投石机……）击杀敌人获得；
- 热武器经验：通过热武器（加农炮塔，火箭炮塔，电磁炮……）击杀敌人获得；
- 农耕经验：每次收获粮食时获得；
- 防御经验：防御类建筑（篱笆，高压铁丝网，城墙）被攻击时获得；
- 科技值：随着游戏的进展不断增加；
- 经济实力：出口商品时获得；
- 技术：从商店买入；

这里列举一些增益的解锁条件：

- 冷兵器攻速*105%：冷兵器经验达到5；
- 风调雨顺（农业生产有几率翻倍）：农耕经验达到10；种植业技术；
- 现代工业（炼铁厂与木材加工厂资源转化率提高）：科技值达到100；经济实力达到50；工业加工技术；

------



# <u>游戏阶段</u>

根据不同的阶段来执行相应的程序

## 第一阶段：

​	玩家选择主基地的位置并放置

## 第二阶段：

​	选卡

## 第三阶段：

​	游戏正式开始，开始出怪，玩家可以进行各种操作（放置建筑......）

## 第四阶段：

​	游戏结束（失败，胜利）

------



# **<u>制作步骤</u>**

*以下步骤均为第一次制定，中途如有新的要求再进行添加*

## 第一部分：实现所有资源的获取

- [x] ## 制作游戏地图

- [x] ## 实现摄像机的移动与缩放功能

- [x] ## 初步实现防止建筑的功能

- [x] ## 完成第一阶段的初步制作

- [x] ## 搭建选卡UI

- [x] ## 完成选卡功能

- [x] ## 实现建筑的选择与放置

- [x] ## 实现运输中心的功能（开发运输系统）

- [x] ## 制作资源点（铁、煤、森林、山）

- [x] ## 实现矿井、采石场、伐木场的功能

- [x] ## 开发选择建筑的UI

- [x] 1.构思UI

- [x] 2.搭建UI

- [x] 3.实现玩家点击建筑能弹出UI并能点击其他位置关闭UI的功能（当玩家打开UI时，把selectedBuilding设置为null（即将已经选择的建筑变量设为空））

- [x] 4.实现UI能够显示建筑是否正在运行，是否连接到主基地的功能

- [x] 5.实现摧毁建筑按钮的功能

- [x] 6.实现运行开关按钮的功能

- [x] 7.实现矿井建筑UI中选择资源开采类型的按钮

- [x] ## 实现炼铁厂、木材加工厂、抽水机的功能

- [x] 1.炼铁厂

- [x] 2.木材加工厂

- [x] 3.抽水机

- [x] ## 开发商店系统

- [x] 1.搭建UI

- [x] 2.实现商店翻页，关闭，打开的功能

- [x] 3.实现买卖资源的功能

- [x] ## 实现热电站、核电站的功能

- [x] ## 实现放置建筑时需要资源才能放置的功能

- [x] 1.实现玩家鼠标悬浮在建筑选择的按钮上会有显示其需要资源的UI

- [x] 2.根据selectedBuildingToBuild来确定放置所需要的资源，进一步进行判断才可以放置

- [x] ## 开发时间系统

- [x] ## 开发天气系统

- [x] ## 实现耕地、杂交水稻、农业大棚的功能

- [x] ## 实现所有资源数量的UI显示

- [x] ## 实现建筑的运行消耗

## 第二部分：敌人的制作

- [ ] ## 实现敌人按波次生成

- [ ] ## 实现敌人的寻路

- [ ] ## 实现建筑物血量相关功能（扣血与自动回血等）

- [ ] ## 实现普通敌人能攻击建筑物（包括建筑物的扣血与毁灭）

- [ ] ## 制作能远程攻击的敌人

- [ ] ## 制作已经规划好的敌人

## 第三部分：防御塔的制作

- [ ] ## 敌人血量相关功能的实现

- [ ] ## 实现军事基地的功能

- [ ] ## 制作各种防御塔

## 第四部分：技能的实现

- [ ] ## 搭建技能UI

- [ ] ## 实现所有升级条件的获取

- [ ] ## 商店中加入技术

- [ ] ## 实现玩家能够选择增益效果，并实现增益效果

## 第五部分：游戏机制的完善

- [ ] ## 实现游戏的失败与胜利

- [ ] ## 实现每间隔1年让玩家重新选一次卡的功能

- [ ] ## 制作各种游戏关卡

- [ ] ## 搭建主菜单

- [ ] ## 完善主菜单相应功能（选关、图鉴、游戏说明......）

- [ ] ## 实现玩家能中途退出游戏的功能

- [ ] ## 加入背景音乐

- [ ] ## 加入音效（如果没有合适的音效暂时用没声音的audioClip代替，在运行时Debug出来这是什么音效就可以了）

## 第六部分：完善游戏

- [ ] ## 寻找或制作合适的音效与图片，替换制作时用来代替的图片与音频

- [ ] ## 修复已知bug

- [ ] ## 调整游戏数值直至平衡
